# -*-shell-script-*-

. "$genapp_functions/core"

install_agent() {
    cp $plugin_dir/lib/newrelic.jar $app_dir/newrelic.jar
}

install_yml() {
    _yml=$(metadata newrelic_yml)
    echo "$_yml" > $app_dir/newrelic.yml
}

write_java_opts() {
    _config=$control_dir/java-opts-50-newrelic
    echo "Writing newrelic java options to $_config"
    echo "-javaagent:$app_dir/newrelic.jar" >> $_config
    echo "-Dnewrelic.config.file=$app_dir/newrelic.yml" >> $_config
    echo "-Dnewrelic.logfile=$log_dir/newrelic" >> $_config
}

write_jboss_modules_system_pkgs() {
    echo "com.newrelic.agent" \
      > $control_dir/jboss-modules-system-pkgs-newrelic
}
